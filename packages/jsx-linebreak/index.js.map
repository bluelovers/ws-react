{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":";AAAA;;GAEG;;AAEH,mDAAkD;AAmBlD,SAAgB,eAAe,CAAyB,aAA6B,EAAE,QAAQ;IAE9F,OAAO,CAAiE,EACvE,QAAQ,EACR,IAAI,EACJ,MAAM,EACN,GAAG,KAAK,EACL,EAAE,EAAE;QAEP,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAChC;YACC,MAAM,IAAI,SAAS,CAAC,6BAA6B,CAAC,CAAA;SAClD;QAED,IAAI,IAAI,EACR;YACC,QAAQ,GAAG,qBAAI,CAAC,QAAQ,CAAC,CAAC;SAC1B;aAED;YACC,IAAI,CAAC,GAAG,CAAC,CAAC;YAEV,IAAI,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,uBAAM,CAAC,CAAC;YAEnC,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;YAEtB,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;gBAEhC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE;oBAC9B,GAAG,EAAE,CAAC,EAAE;iBACR,EAAE,CAAC,CAAC,CAAC,CAAC;gBACP,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE;oBAC1B,GAAG,EAAE,CAAC,EAAE;iBACR,CAAC,CAAC,CAAC;gBACJ,CAAC,MAAM,IAAI,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE;oBACzC,GAAG,EAAE,CAAC,EAAE;iBACR,EAAE,mBAAE,CAAC,CAAC,CAAC;gBAER,OAAO,CAAC,CAAA;YACT,CAAC,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC,CAAQ,CAAA;SAC1D;QAED,OAAO,aAAa,CAAC,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAA;IAChD,CAAC,CAAA;AACF,CAAC;AA5CD,0CA4CC;AAED,SAAgB,QAAQ,CAAI,aAA6B,EAAE,QAAQ;IAElE,OAAO,CAAC,EACP,GAAG,EACH,GAAG,EACH,GAAG,KAAK,EAIR,EAAE,EAAE,CAAC,aAAa,CAAC,QAAQ,EAAE;QAC7B,GAAG;QACH,GAAG;KACH,EAAE;QACF,aAAa,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC;QAChC,aAAa,CAAC,QAAQ,EAAE,IAAI,EAAE,mBAAE,CAAC;KACjC,CAAC,CAAC;AACJ,CAAC;AAhBD,4BAgBC;AAED,kBAAe,eAAe,CAAA","sourcesContent":["/**\n * Created by user on 2020/1/16.\n */\n\nimport { crlf, R_CRLF, LF } from 'crlf-normalize';\nimport { createElement, Fragment } from 'preact';\n\nexport type IPropLike<T = any> = {\n\tchildren: T\n} | {\n\tchildren?: T\n}\n\nexport type IWarpPropLike<T> = (T | {\n\tchildren?: string\n}) & {\n\t/**\n\t * not convert linebreak to <br/>\n\t */\n\tnoBR?: boolean,\n\tonlyBR?: boolean,\n}\n\nexport function createLinkBreak<P extends IPropLike, N>(createElement: (...argv) => N, Fragment)\n{\n\treturn <T extends IWarpPropLike<P> = IWarpPropLike<P>, V extends N = N>({\n\t\tchildren,\n\t\tnoBR,\n\t\tonlyBR,\n\t\t...props\n\t}: T) =>\n\t{\n\t\tif (typeof children !== 'string')\n\t\t{\n\t\t\tthrow new TypeError(`current only support string`)\n\t\t}\n\n\t\tif (noBR)\n\t\t{\n\t\t\tchildren = crlf(children);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet i = 0;\n\n\t\t\tlet lines = children.split(R_CRLF);\n\n\t\t\tlet end = lines.pop();\n\n\t\t\tchildren = lines.reduce((a, v) => {\n\n\t\t\t\ta.push(createElement(Fragment, {\n\t\t\t\t\tkey: i++\n\t\t\t\t}, v));\n\t\t\t\ta.push(createElement('br', {\n\t\t\t\t\tkey: i++\n\t\t\t\t}));\n\t\t\t\t!onlyBR && a.push(createElement(Fragment, {\n\t\t\t\t\tkey: i++\n\t\t\t\t}, LF));\n\n\t\t\t\treturn a\n\t\t\t}, []).concat([createElement(Fragment, null, end)]) as any\n\t\t}\n\n\t\treturn createElement(Fragment, props, children)\n\t}\n}\n\nexport function createBR<N>(createElement: (...argv) => N, Fragment)\n{\n\treturn ({\n\t\tkey,\n\t\tref,\n\t\t...props\n\t} : {\n\t\tkey?,\n\t\tref?,\n\t}) => createElement(Fragment, {\n\t\tkey,\n\t\tref,\n\t}, [\n\t\tcreateElement('br', props, null),\n\t\tcreateElement(Fragment, null, LF),\n\t]);\n}\n\nexport default createLinkBreak\n"]}