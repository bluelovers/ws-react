{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;;AAEH,6FAA+F;AAE/F,iFAA0D;AAS1D,SAAgB,MAAM,CAAuH,UAEzI,EAAE;IAQL,IAAI,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC;IAExB,KAAK,GAAG,KAAK,IAAI,IAAI,OAAO,EAAoC,CAAC;IAEjE,MAAM,QAAQ,GAAG,SAAS,QAAQ;QAEjC,MAAM,KAAK,GAAG,kBAAS,EAAK,CAAC;QAE7B,IAAI,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAEhC,OAAO;YACN,KAAK;YACL,QAAQ;SACR,CAAA;IACF,CAAC,CAAC;IAEF,MAAM,WAAW,GAAG,SAAS,WAAW,CAAC,OAAW,EAAE,SAErD,EAAE,GAAG,IAAc;QAEnB,MAAM,KAAK,GAAG,wBAAe,CAAC,OAAO,EAAE,SAAS,EAAE,GAAG,IAAI,CAAM,CAAC;QAEhE,IAAI,SAAS,IAAI,SAAS,CAAC,QAAQ,EACnC;YACC,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG,SAAS,CAAC;YAExC,MAAM,QAAQ,GAAkC,KAAK,WAAW,KAAK,EAAE,UAAoB;gBAE1F,IAAI,UAAU,IAAI,OAAO,KAAK,KAAK,UAAU,EAC7C;oBACC,OAAO,SAAS,CAAC,GAAG,CAAC,EAAE;wBAEtB,IAAI,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;wBAEnB,IAAI,CAAC,IAAI,OAAO,CAAC,KAAK,QAAQ,EAC9B;4BACC,OAAO;gCACN,GAAG,CAAC;6BACJ,CAAA;yBACD;wBAED,OAAO,CAAC,CAAC;oBACV,CAAC,CAAC,CAAA;iBACF;gBAED,OAAO,SAAS,CAAC,KAAK,CAAC,CAAA;YACxB,CAAC,CAAC;YAEF,KAAK,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;YAE3B,OAAO;gBACN,KAAK;gBACL,QAAQ;aACR,CAAC;SACF;QAED,OAAO;YACN,KAAK;SACL,CAAA;IACF,CAAC,CAAC;IAEF,OAAO;QACN,KAAK;QACL,QAAQ;QACR,WAAW;KACX,CAAA;AACF,CAAC;AA5ED,wBA4EC;AAED,kBAAe,MAAM,CAAA","sourcesContent":["/**\n * Created by user on 2020/1/13.\n */\n\nimport _createMuiTheme, { ThemeOptions, Theme } from '@material-ui/core/styles/createMuiTheme';\nimport { ITSResolvable } from 'ts-type';\nimport _useTheme from '@material-ui/core/styles/useTheme';\nimport { Dispatch, SetStateAction } from 'react';\n\nexport interface IThemeExtra<T extends Theme = Theme, O extends ThemeOptions = ThemeOptions>\n{\n\ttheme: T;\n\tsetTheme?(theme: SetStateAction<T | O>, autoSpread?: boolean): ITSResolvable<void | T | O>;\n}\n\nexport function create<T extends Theme = ReturnType<typeof _createMuiTheme>, O extends ThemeOptions = Parameters<typeof _createMuiTheme>[0]>(options: {\n\tstore?: WeakMap<T, IThemeExtra<T, O>[\"setTheme\"]>;\n} = {}): {\n\tstore: WeakMap<T, IThemeExtra<T, O>[\"setTheme\"]>;\n\tuseTheme(): IThemeExtra<T, O>;\n\tcreateTheme(options?: O, optsExtra?: {\n\t\tsetTheme?: Dispatch<SetStateAction<T | O>>;\n\t}, ...args: object[]): IThemeExtra<T, O>;\n}\n{\n\tlet { store } = options;\n\n\tstore = store || new WeakMap<T, IThemeExtra<T, O>[\"setTheme\"]>();\n\n\tconst useTheme = function useTheme(): IThemeExtra<T, O>\n\t{\n\t\tconst theme = _useTheme<T>();\n\n\t\tlet setTheme = store.get(theme);\n\n\t\treturn {\n\t\t\ttheme,\n\t\t\tsetTheme,\n\t\t}\n\t};\n\n\tconst createTheme = function createTheme(options?: O, optsExtra?: {\n\t\tsetTheme?: Dispatch<SetStateAction<T | O>>\n\t}, ...args: object[]): IThemeExtra<T, O>\n\t{\n\t\tconst theme = _createMuiTheme(options, optsExtra, ...args) as T;\n\n\t\tif (optsExtra && optsExtra.setTheme)\n\t\t{\n\t\t\tlet { setTheme: _setTheme } = optsExtra;\n\n\t\t\tconst setTheme: IThemeExtra<T, O>[\"setTheme\"] = async function (value, autoSpread?: boolean)\n\t\t\t{\n\t\t\t\tif (autoSpread && typeof value === 'function')\n\t\t\t\t{\n\t\t\t\t\treturn _setTheme(old => {\n\n\t\t\t\t\t\tlet n = value(old);\n\n\t\t\t\t\t\tif (n && typeof n === 'object')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn n;\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn _setTheme(value)\n\t\t\t};\n\n\t\t\tstore.set(theme, setTheme);\n\n\t\t\treturn {\n\t\t\t\ttheme,\n\t\t\t\tsetTheme\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttheme,\n\t\t}\n\t};\n\n\treturn {\n\t\tstore,\n\t\tuseTheme,\n\t\tcreateTheme,\n\t}\n}\n\nexport default create\n"]}